capex_task:
  description: >-
    Research capital expenditure trends for the following tickers: {tickers}.
    For each company, compute the percentage change in capital expenditures
    between the latest two reporting periods using available financial data.
    If the increase exceeds 20%, note this as a strong capex signal.
    Present the results as a list of objects with fields: ticker,
    latest_period, previous_period, latest_capex_mil, previous_capex_mil,
    capex_growth_pct and a boolean flag indicating whether capex_growth_pct >= 0.20.
  expected_output: >-
    A JSON serialisable list of dictionaries summarising the capex analysis
    for each ticker.  Example: [{"ticker": "GE", "capex_growth_pct": 0.25,
    "strong_signal": true}, …]

pricing_task:
  description: >-
    Analyse price movements of critical commodities and components.  Using
    the default commodity tickers, calculate the percentage change in
    closing prices over the last 30 days.  Identify any instruments whose
    price has risen more than 5%.  Return a list of objects with fields:
    ticker, start_date, end_date, start_price, end_price, price_change_pct
    and a boolean flag signalling that price_change_pct >= 0.05.
  expected_output: >-
    A JSON serialisable list of dictionaries summarising the instruments
    that experienced significant price increases.  Example:
    [{"ticker": "NG=F", "price_change_pct": 0.12, "spike": true}, …]

rotation_task:
  description: >-
    Evaluate sector performance relative to the S&P 500 over the past 30
    days.  For each of the default sector ETFs, compute the trailing
    return, the market return, the relative return (sector minus market),
    and the ratio of days where the sector gained while the market was
    down.  Rank the sectors by relative return and flag any sectors with
    positive relative return and a defensive ratio above 0.4 as potential
    rotation targets.
  expected_output: >-
    A JSON serialisable list of objects with fields: ticker, name,
    trailing_return, market_return, relative_return, up_on_down_days_ratio,
    and a boolean flag "rotation_signal" indicating sectors that meet both
    positive relative return and defensive ratio criteria.

recommendation_task:
  description: >-
    Synthesise the findings from the capex, pricing and rotation analyses
    to produce stock‑specific investment recommendations.  The primary
    goal is to surface attractive **buy** candidates because the user
    currently holds no positions.  Use the following guidance:

    * Treat price spikes in commodities and sector rotation signals as
      indicators of tightening supply or shifting institutional flows, but
      **do not** pass those commodity tickers (e.g. futures like HG=F) into
      the Sell Signal Detector.  The sell detector should only be run
      against the input stock tickers (e.g. GE, ETN, CMI, etc.).

    * A "buy" recommendation should be issued for a stock when it shows
      strong capex growth (capex up 20%+), its input commodities have
      experienced significant price spikes, and its sector exhibits
      outperformance with defensive characteristics.  Provide a concise
      justification citing the signals.

    * A "hold" or "sell" rating should **only** be issued for a stock
      after it has previously been recommended for purchase and now
      triggers a red flag (fundamental peak, technical exhaustion or
      distribution cluster) via the Sell Signal Detector.  In monitoring
      mode (initial analysis), avoid assigning hold or sell to a stock
      unless a compelling red flag is present.

    Always cite the quantitative data from the earlier analyses (capex
    growth percentages, price change percentages, relative returns,
    defensive ratios) and clearly explain the rationale for each
    recommendation.  Present your output as a JSON object with a
    "summary" field and a "recommendations" list.  Each entry in the
    recommendations list should include the ticker, a rating (buy, hold or
    sell) and a brief reason.
  expected_output: >-
    A structured report comprising a summary paragraph and a list of
    recommended tickers with ratings ("buy", "hold" or "sell").  Example:
    {"summary": "Utilities and Industrials are showing rotation but GE
    exhibits inventory build‑up…", 
    "recommendations": [
      {"ticker": "ETN", "rating": "buy", "reason": "Capex up 35%, commodity
      price spike, no red flags"},
      {"ticker": "GE", "rating": "sell", "reason": "Inventory growth far
      outpaces revenue and RSI divergence"}
    ]}